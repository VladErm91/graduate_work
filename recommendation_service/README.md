–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

## 1. –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:

- PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤, –ª–∞–π–∫–æ–≤ –∏ –≤–µ—Å–æ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

- ClickHouse –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ (CTR, Conversion, Engagement).

- Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤.

- MinIO –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—É—á–µ–Ω–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π (–µ—â–µ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ).

## 2. –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã:

- FastAPI API ‚Äî –≥–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–π –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

- Recommendation Worker ‚Äî —Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π, —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫, –∞–Ω–∞–ª–∏–∑–∞ A/B-—Ç–µ—Å—Ç–æ–≤.

## 3. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:

- A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ (A –∏ B).

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ—Å–æ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫.

- –£—á–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∏ –ª–∞–π–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## 4. –°–±–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫:

- –§–∏–∫—Å–∞—Ü–∏—è –∫–ª–∏–∫–æ–≤, –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∏ —É—Å–ø–µ—à–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

- –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤ ClickHouse.

- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

üìå –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

```plaintext
                           +--------------------+
                           |  User Interface    |
                           +--------------------+
                                    |
                                    ‚ñº
                     +-----------------------------------+
                     |      FastAPI Recommendation API  |
                     |   - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π       |
                     |   - –õ–æ–≥–∏–∫–∞ A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è      |
                     |   - –ó–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤    |
                     +-----------------------------------+
                                    |
          +-------------------------+-------------------------+
          |                                                   |
          ‚ñº                                                   ‚ñº
+----------------------+                             +----------------------+
|   PostgreSQL         |                             |   ClickHouse         |
| - –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ |<--- (Recommendation Worker) | - –ú–µ—Ç—Ä–∏–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ |
| - –õ–∞–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π|                             | - CTR, Conversion    |
+----------------------+                             +----------------------+
          |                                                   |
          |                                                   |
          ‚ñº                                                   ‚ñº
+----------------------+                             +----------------------+
|   Redis Cache        |                             |   Kafka              |
| - –ì–æ—Ä—è—á–∏–µ —Ñ–∏–ª—å–º—ã     |<--- (API)                   | - –û—á–µ—Ä–µ–¥—å –∫–ª–∏–∫–æ–≤     |
+----------------------+                             | - –ú–µ—Ç—Ä–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π |
                                                    +----------------------+

```

üìå –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–∞
–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º DDD (Domain-Driven Design) –∏ —á–∏—Å—Ç—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, —Ä–∞–∑–¥–µ–ª—è—è –∫–æ–¥ –Ω–∞ —Å–ª–æ–∏:

api/ ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (endpoints)

services/ ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

repositories/ ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

models/ ‚Äî SQLAlchemy-–º–æ–¥–µ–ª–∏

schemas/ ‚Äî Pydantic-—Å—Ö–µ–º—ã

core/ ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∫–æ–Ω—Ñ–∏–≥–∏

main.py ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

```bash
cd recommendation_service/
docker-compose down -v
docker-compose up --build -d
docker-compose exec fastapi alembic revision --autogenerate -m "Initial migration"
docker-compose exec fastapi alembic upgrade head
docker-compose exec fastapi python scripts/generate_test_data.py
docker-compose exec fastapi python -c "from tasks import train_model; import asyncio; asyncio.run(train_model())"

```
